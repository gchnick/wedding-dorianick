---
import { Image } from "astro:assets";

import Anchor from "@/components/Anchor.astro";
import MemoryPhoto from "@/components/MemoryPhoto.astro";
import ourStory1 from "@/assets/our-story-1.webp";
import ourStory2 from "@/assets/our-story-2.webp";
import Title from "@/components/Title.astro";
---

<Anchor id="our-history" />
<section class="py-20 bg-white">
  <div class="container mx-auto px-4 max-w-6xl">
    <Title>Nuestra historia</Title>
    <div class="flex flex-col md:flex-row items-center gap-12">
      <!-- Image Side -->
      <div class="w-full md:w-1/2 flex justify-center">
        <div
          class="relative w-full max-w-md aspect-3/4 cursor-pointer group"
          id="story-photo-container"
        >
          <!-- Background decoration -->
          <div
            class="absolute inset-0 bg-primary-accent/10 transform translate-x-4 translate-y-4 rounded-lg -z-10"
          >
          </div>

          <!-- Bottom Photo (Initially) -->
          <div
            class="absolute inset-0 transition-all duration-700 ease-in-out transform rotate-3 scale-95 opacity-80"
            id="photo-bottom"
          >
            <Image
              src={ourStory2}
              alt="隆Dije que s铆! "
              class="w-full h-full object-cover rounded-lg shadow-lg"
            />
          </div>

          <!-- Top Photo (Initially) -->
          <div
            class="absolute inset-0 transition-all duration-700 ease-in-out transform -rotate-2 z-10 shadow-xl"
            id="photo-top"
          >
            <Image
              src={ourStory1}
              alt="隆M铆 mejor compa帽er@ de predicaci贸n!"
              class="w-full h-full object-cover object-right rounded-lg"
            />
          </div>

          <!-- Hint -->
          <div
            class="absolute -bottom-8 left-0 right-0 text-center opacity-0 group-hover:opacity-100 transition-opacity duration-300"
          >
            <span class="text-sm text-neutral-mid italic"
              >Click para cambiar foto</span
            >
          </div>
        </div>
      </div>

      <!-- Text Side -->
      <div class="w-full md:w-1/2 text-center md:text-left">
        <h2
          class="font-body font-semibold text-3xl md:text-4xl text-neutral-500 mb-6"
        >
          Un saludo que lo cambi贸 todo
        </h2>
        <div class="space-y-4 text-neutral-mid leading-relaxed">
          <p class="text-pretty">
            Nuestra historia comenz贸 el <strong class="font-bold"
              >3 de enero de 2020</strong
            >, en un entorno muy especial para ambos: la reuni贸n de precursores
            del Circuito Barinas 1. Fue un d铆a para recordar, no solo porque nos
            conocimos, sino porque estren谩bamos esa reuni贸n en el Sal贸n del
            Reino de Sabaneta de Barinas. Sin embargo, en ese momento, nuestros
            caminos solo se rozaron brevemente.
          </p>
          <MemoryPhoto />
          <p class="text-pretty">
            Pasaron tres a帽os en silencio, cada uno enfocado en su servicio,
            hasta aquel <strong class="font-bold">8 de mayo de 2023</strong>. Lo
            que comenz贸 como un simple mensaje para saludarnos y saber c贸mo
            estaban nuestras familias, se transform贸 inesperadamente. Entre
            l铆neas descubrimos una conexi贸n profunda; nos dimos cuenta de que
            nuestras experiencias pasadas y nuestras metas espirituales estaban
            en perfecta sinton铆a. Esa conversaci贸n cordial se convirti贸 en una
            amistad inquebrantable y, finalmente, en el amor que celebramos hoy
            con ustedes.
          </p>
        </div>
        <div class="mt-8">
          <img
            src="/favicon-leaf.svg"
            alt="D y N"
            class="w-20 mx-auto md:mx-0"
          />
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  const container = document.getElementById("story-photo-container");
  const photoTop = document.getElementById("photo-top");
  const photoBottom = document.getElementById("photo-bottom");

  let isSwapped = false;

  container?.addEventListener("click", () => {
    isSwapped = !isSwapped;

    if (isSwapped) {
      // Swap animation
      photoTop?.classList.remove("-rotate-2", "z-10", "shadow-xl");
      photoTop?.classList.add("rotate-3", "scale-95", "opacity-80", "z-0");

      photoBottom?.classList.remove("rotate-3", "scale-95", "opacity-80");
      photoBottom?.classList.add("-rotate-2", "z-10", "shadow-xl");
    } else {
      // Revert animation
      photoTop?.classList.add("-rotate-2", "z-10", "shadow-xl");
      photoTop?.classList.remove("rotate-3", "scale-95", "opacity-80", "z-0");

      photoBottom?.classList.add("rotate-3", "scale-95", "opacity-80");
      photoBottom?.classList.remove("-rotate-2", "z-10", "shadow-xl");
    }
  });
</script>
