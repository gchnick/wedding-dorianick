---
import { weddingDate, weddingDateStringWithDay } from "@/constans/const";
import Anchor from "@/components/Anchor.astro";
import LiveStreamIcon from "@/assets/icons/live-stream.svg";
import { LiveStreamCredentials } from "@/components/LiveStreamCredentials";

// Calcular 24 horas antes del evento (en milisegundos)
const TWENTY_FOUR_HOURS_MS = 24 * 60 * 60 * 1000;
const credentialsAvailableDate = new Date(weddingDate.getTime() - TWENTY_FOUR_HOURS_MS);

// Verificar si las credenciales están disponibles (SSR - se ejecuta en el servidor)
const areCredentialsAvailable = Date.now() >= credentialsAvailableDate.getTime();

import Paragraph from "@/components/Paragraph.astro";
import Title from "@/components/Title.astro";
---

<Anchor id="live-stream" />
<section class="py-20 bg-neutral-900 text-white">
  <div class="container mx-auto px-4 max-w-4xl text-center">
    <div class="inline-block p-4 rounded-full bg-white/10 mb-8 animate-pulse">
      <LiveStreamIcon aria-label="Icono de trasmisión en vivo" />
    </div>

    <Title dark>Transmisión en vivo</Title>

    <Paragraph dark>
      Si no puedes acompañarnos físicamente, nos encantaría que fueras parte de
      nuestro gran día de manera virtual.
    </Paragraph>

    <Paragraph dark class="text-sm text-neutral-400 italic mb-4">
      Las credenciales de acceso estarán disponibles 24 horas antes del evento.
    </Paragraph>

    <div
      class="bg-white/5 border border-white/10 rounded-xl p-8 mb-12 backdrop-blur-sm"
    >
      <div class="grid md:grid-cols-3 gap-8 text-center items-center">
        <div>
          <span
            class="font-body block text-sm text-neutral-400 uppercase tracking-wider mb-2"
            >Fecha</span
          >
          <span class="font-body text-xl">{weddingDateStringWithDay}</span>
        </div>
        <div>
          <span
            class="font-body block text-sm text-neutral-400 uppercase tracking-wider mb-2"
            >Hora</span
          >
          {/* Hora de Venezuela */}
          <span class="font-body text-xl">6:30 PM</span>
        </div>
        <div>
          <span
            class="font-body block text-sm text-neutral-400 uppercase tracking-wider mb-2"
            >Plataforma</span
          >
          <span class="font-body text-xl">Zoom</span>
        </div>
      </div>
    </div>

    <LiveStreamCredentials
      client:load
      credentialsAvailableDate={credentialsAvailableDate}
      initialAreCredentialsAvailable={areCredentialsAvailable}
    />
  </div>
</section>
